<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Migrating an existing project to use workflowr • workflowr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/readable/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">workflowr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/wflow-01-getting-started.html">Getting started</a>
</li>
<li>
  <a href="../articles/wflow-05-faq.html">FAQ</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jdblischak/workflowrBeta">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Migrating an existing project to use workflowr</h1>
            <h3 class="subtitle">workflowr version 0.12.0</h3>
                        <h4 class="author">John Blischak</h4>
            
            <h4 class="date">2018-04-02</h4>
          </div>

    
    
<div class="contents">
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This vignette is for those users that already have an existing project and wish to incorporate workflowr to create a research website. Migrating an existing project to use workflowr varies from straightforward to difficult depending on the scenario and your comfort level with Git. This vignette assumes that you have the background knowledge of workflowr explained in the <a href="wflow-01-getting-started.html">Getting started</a> vignette. Even if you have no need for a new workflowr project, please run through that vignette first as an exercise to familiarize yourself with the workflowr philosophy and functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">vignette</span>(<span class="st">"wflow-01-getting-started"</span>, <span class="st">"workflowr"</span>)</code></pre></div>
</div>
<div id="scenario-i-have-a-collection-of-r-markdown-files" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-i-have-a-collection-of-r-markdown-files" class="anchor"></a>Scenario: I have a collection of R Markdown files</h2>
<p>If you have a collection of R Markdown files, but no version control or other files, the most straightforward solution would be to create a workflowr project in a new directory and then move the R Markdown files to the <code>analysis/</code> subdirectory. In the hypothetical example below, the original R Markdown files are located in the directory <code>~/projects/misc/</code> and the workflowr project will be created in the new directory <code>~/projects/new-project/</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"workflowr"</span>)
<span class="co"># Create project directory and change working directory to this location</span>
<span class="kw"><a href="../reference/wflow_start.html">wflow_start</a></span>(<span class="st">"~/projects/new-project"</span>)
<span class="co"># Copy the files to the analysis subdirectory of the workflowr project</span>
<span class="kw">file.copy</span>(<span class="dt">from =</span> <span class="kw">Sys.glob</span>(<span class="st">"~/projects/misc/*Rmd"</span>), <span class="dt">to =</span> <span class="st">"analysis"</span>)</code></pre></div>
<p>Next update your R Markdown files to use the workflowr template (you can first run <code><a href="../reference/wflow_update.html">wflow_update()</a></code> with no arguments to preview the potential changes).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/wflow_update.html">wflow_update</a></span>(<span class="dt">dry_run =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Lastly, build and commit the website using <code><a href="../reference/wflow_publish.html">wflow_publish()</a></code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/wflow_publish.html">wflow_publish</a></span>(<span class="st">"analysis/*Rmd"</span>, <span class="st">"Publish analysis files"</span>)</code></pre></div>
</div>
<div id="scenario-i-have-a-collection-of-r-markdown-files-and-other-project-infrastructure" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-i-have-a-collection-of-r-markdown-files-and-other-project-infrastructure" class="anchor"></a>Scenario: I have a collection of R Markdown files and other project infrastructure</h2>
<p>If your project already has lots of infrastructure, it is most convenient to add the workflowr files directory to your already existing directory. This is controlled with the argument <code>existing</code>. In the hypothetical example below, the existing project is located at <code>~/projects/mature-project/</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"workflowr"</span>)
<span class="kw"><a href="../reference/wflow_start.html">wflow_start</a></span>(<span class="st">"~/projects/mature-project"</span>, <span class="dt">existing =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>The above command will add the workflowr files to your existing project and also commit them to version control (it will initialize a Git repo if it doesn’t already exist). If you’d prefer to not use version control for your project or you’d prefer to commit the workflowr files yourself manually, you can set <code>git = FALSE</code> (this is also useful if you want to first test to see what would happen without committing the results).</p>
<p>By default <code><a href="../reference/wflow_start.html">wflow_start()</a></code> will not overwrite your existing files (e.g. if you already have a <code>README.md</code>). If you’d prefer to overwrite your files with the default workflowr files, set <code>overwrite = TRUE</code>.</p>
<p>To add your R Markdown files to the research website, you can move them to the subdirectory <code>analysis/</code> (note you can do this before or after running <code><a href="../reference/wflow_start.html">wflow_start()</a></code>).</p>
<p>Next run <code><a href="../reference/wflow_update.html">wflow_update()</a></code> to convert the R Markdown files to use the workflowr template:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/wflow_update.html">wflow_update</a></span>(<span class="dt">dry_run =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Lastly, build and commit the website using <code><a href="../reference/wflow_publish.html">wflow_publish()</a></code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/wflow_publish.html">wflow_publish</a></span>(<span class="st">"analysis/*Rmd"</span>, <span class="st">"Publish analysis files"</span>)</code></pre></div>
</div>
<div id="scenario-i-have-an-r-package" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-i-have-an-r-package" class="anchor"></a>Scenario: I have an R package</h2>
<p>If your project is organized as an R package, you can still add a website using workflowr. In the hypothetical example below, the existing package is located at <code>~/projects/my-package/</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"workflowr"</span>)
<span class="kw"><a href="../reference/wflow_start.html">wflow_start</a></span>(<span class="st">"~/projects/my-package"</span>, <span class="dt">existing =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>The above command will add the workflowr files to your existing project and also commit them to version control (it will initialize a Git repo if it doesn’t already exist). If you’d prefer to not use version control for your project or you’d prefer to commit the workflowr files yourself manually, you can set <code>git = FALSE</code> (this is also useful if you want to first test to see what would happen without committing the results).</p>
<p>You’ll want R to ignore the workflowr directories when building the R package. Thus add the following to the <code>.Rbuildignore</code> file:</p>
<pre><code>^analysis$
^docs$
^data$
^code$
^output$</code></pre>
<p>If your primary purpose for creating a website to accompany your package is to share the package documentation, please check out the package <a href="https://github.com/hadley/pkgdown">pkgdown</a>. It creates a website from the vignettes and function documentation files (i.e. the Rd files in <code>man/</code>). In contrast, if the purpose of the website is to demonstrate results you obtained using the package, use workflowr.</p>
</div>
<div id="scenario-i-have-an-ashlar-project" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-i-have-an-ashlar-project" class="anchor"></a>Scenario: I have an ashlar project</h2>
<p>If your project uses the <a href="https://github.com/jhsiao999/ashlar">ashlar</a> template, you’ll need to follow multiple steps to convert it to a valid workflowr setup.</p>
<p>First, make sure you are in the “master” branch. Also, you should run the following Git commands from the base of the project directory.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">git</span> checkout master</code></pre></div>
<p>If you have any HTML files in <code>analysis/</code> remove them using Git at the command line.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">git</span> rm analysis/*html</code></pre></div>
<p>Next remove the other ashlar infrastructure files.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">git</span> rm analysis/chunk-options.R analysis/Makefile analysis/_output.yaml
<span class="fu">git</span> rm -r analysis/libs analysis/include analysis/figure</code></pre></div>
<p>Modify <code>.gitignore</code> so that it ignores HTML and figure files in <code>analysis/</code> only by changing <code>*html</code> to <code>analysis/*html</code> and <code>*png</code> to <code>analysis/figure</code>. Afterwards add the file.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">nano</span> .gitignore
<span class="fu">git</span> add .gitignore</code></pre></div>
<p>And move the RStudio project file from <code>analysis/</code> to the base of the project.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">git</span> mv analysis/*Rproj .</code></pre></div>
<p>Commit these changes.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">git</span> commit -m <span class="st">"Removed ashlar infrastructure."</span></code></pre></div>
<p>Next open R to add the workflowr files. In the hypothetical example below, the existing package is located at <code>~/projects/ashlar-project/</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"workflowr"</span>)
<span class="kw"><a href="../reference/wflow_start.html">wflow_start</a></span>(<span class="st">"~/projects/ashlar-project"</span>, <span class="dt">existing =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>This will generate a few warning messages stating that the directory already contains a <code>.git</code> directory and a <code>.gitignore</code> file. These can be safely ignored because ashlar projects are expected to be using Git for version control.</p>
<p>Lastly, you’ll need to update your R Markdown files to use the workflowr template, which you can do using the function <code><a href="../reference/wflow_update.html">wflow_update()</a></code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/wflow_update.html">wflow_update</a></span>()
<span class="co"># Run with `dry_run = FALSE` to apply the updates</span>
<span class="co"># wflow_update(dry_run = FALSE)</span></code></pre></div>
<p>This will update every R Markdown file, with the exception of <code>index.Rmd</code>, <code>about.Rmd</code>, and <code>license.Rmd</code>. It will also fail to automatically convert any ashlar files that do not follow the template (e.g. they do not have the <code>sessionInfo()</code> chunk), so you will have to manually update these files. Also, workflowr no longer includes the date and SHA1 in the organizational files like <code>index.Rmd</code>, so you can remove this manually if you like.</p>
<p>Now you should have a functioning workflowr project! From here you should be able to make a few more small edits and then follow the workflowr steps to create your website:</p>
<ul>
<li>Edit the navbar in <code>analysis/_site.yml</code> so that the GitHub URL points to your repository (and commit the change)</li>
<li>Edit the README (and potentially other places, including on GitHub) so that the URL to the website no longer contains the trailing “analysis” in the name (and commit the change(s))</li>
<li>Run <code>wflow_publish("analysis/*Rmd", "Publish files using workflowr"))</code> to build and commit the website files</li>
<li>Push the changes to GitHub</li>
<li>Change the Settings so that the website is served from “master branch /docs folder”</li>
<li>Optionally remove the gh-pages branch (<a href="https://github.com/blog/1377-create-and-delete-branches">GitHub instructions</a>)</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#scenario-i-have-a-collection-of-r-markdown-files">Scenario: I have a collection of R Markdown files</a></li>
      <li><a href="#scenario-i-have-a-collection-of-r-markdown-files-and-other-project-infrastructure">Scenario: I have a collection of R Markdown files and other project infrastructure</a></li>
      <li><a href="#scenario-i-have-an-r-package">Scenario: I have an R package</a></li>
      <li><a href="#scenario-i-have-an-ashlar-project">Scenario: I have an ashlar project</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by John Blischak, Peter Carbonetto, Matthew Stephens.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
